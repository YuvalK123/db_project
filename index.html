
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="crossorigin="anonymous"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
            integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
            crossorigin="anonymous">

        <!-- Optional theme -->
        <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
            integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
            crossorigin="anonymous">

        <!-- Latest compiled and minified JavaScript -->
        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
        <style>
            .colored{
                background-color: blueviolet;
                outline: 5px auto -webkit-focus-ring-color;
            }
            .coloredBlue{
                background-color: cyan;
                outline: 5px auto -webkit-focus-ring-color;
            }

            .good{
                background-color: green;
                border: 2px solid #000 !important;
            }

        </style>
    </head>
    <body>
        <script>
            var username;
            var points = 0;
            var mistakes = 5;
            var wordOrg;
            var word;
            var url = "localhost";
            var port = 3000;
            var selectedPosition;
            var correctCount=0;
            var hiddenLen = 0;
            var hints = [];
            var hintCount = 0;
            var wLen;
            var hiddenWord;
            var letterOptions = new Array(parseInt(26));; 
            var isWin = false;
            $("#instr").html("<br>Select the position and then guess the letters")
            $("#Mis").html(mistakes);
            $(document).ready(()=>{
                $.ajax({ 
                    type: 'GET', 
                    contentType: "application/json; charset=utf-8",
                    url: url+"/"+port+'/get_country', 
                    success: function (data) {
                        wordOrg = data;
                        word = wordOrg.toLowerCase();
                        wLen = word.length
                        hiddenWord = new Array(wLen);
                    },
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
	    	
                    }  
                });
                $("#play").click(()=>{

                    for(var i=0;i<wLen;i++){
                        hiddenWord[i]=["_",word[i]];
                    }
                    for(var i=0;i<wLen;i++){
                        if(hiddenWord[i][1]==" "||hiddenWord[i][1]=="-"||hiddenWord[i][1]=="_"){
                            $("#word").append("<span id='"+i+"' class='btn' style='background-color:white;color:black;margin-right:10px;width:70px;margin-bottom:10px' disabled>"+hiddenWord[i][1]+"</span>")
                        }
                        else{
                            $("#word").append("<span id='"+i+"' class='btn wordLettes' style=';background-color:white;color:black;margin-right:10px;width:70px;margin-bottom:10px'>"+hiddenWord[i][0]+"</span>")
                            hiddenLen++;
                        }
                    }
                    var alphabet = "abcdefghijklmnopqrstuvwxyz"
                    for(var i=0;i<26;i++){
                        letterOptions[i] = alphabet[i]
                    }
                    letterOptions = shuffle(letterOptions)

                    for(var i=0;i<26;i++){
                        $("#lettersOption").append("<button class='btn LettersOp' style='color:black;margin-right:10px;width:50px;margin-bottom:10px' >"+letterOptions[i]+"</button>")
                    }

                    username= $("#username").val();
                    $("#loginScreen").hide();
                    $("#playScreen").show();
                    $("#welcome").html("Welcome "+ username+"!" )
                });

                $("#hint").click(()=>{
                    $.ajax({ 
                        type: 'GET', 
                        contentType: "application/json; charset=utf-8",
                        url: url+"/"+port+'/hint?country='+wordOrg, 
                        success: function (data) {
                            alert(data);
                            hintCount++;
                        },
                        error: function(XMLHttpRequest, textStatus, errorThrown) {
                
                        }  
                    });

                });

            $("#playAgain").click(()=>{
                location.reload();
            });
            
              $(document).on('click',".LettersOp",(event)=>{
                $(".LettersOp").removeClass("coloredBlue");
                $(event.target).addClass("coloredBlue")
                wrongFlag = true;
                for(var i=0;i<hiddenWord.length;i++){
                    if($(event.target).text() == hiddenWord[i][1]){
                        wrongFlag = false;
                        $("#"+i).text(wordOrg[i])
                        $("#"+i).removeClass("colored");
                        $("#"+i).addClass("good");
                        $("#"+i).attr("disabled","disabled");
                        $("#instr").show();
                        $(event.target).remove();
                        correctCount++;
                        if(checkWin()){
                            isWin = true;
                            $.ajax({ 
                                type: 'GET', 
                                contentType: "application/json; charset=utf-8",
                                url: url+"/"+port+"/get_people?country="+wordOrg, 
                                success: function (data) {
                                    $("#city").html(wordOrg)
                                    $("#dataModal").modal("show");
                                    $("#info").html(data);
                                    $("#modTitle").html("You Won! The Answer was " + wordOrg);
                                    $("#game").hide();
                                    $("#again").show();
                                },
                                error: function(XMLHttpRequest, textStatus, errorThrown) {
                        
                                }  
                            });

                        }
                    }
                }
                if(wrongFlag){
                    alert("Wrong letter! " + (--mistakes) +" mistaked left");
                    $("#Mis").html(mistakes);
                    if(mistakes <= 0){

                        $.ajax({ 
                            type: 'GET', 
                            contentType: "application/json; charset=utf-8",
                            url: url+"/"+port+"/get_people?country="+wordOrg, 
                            success: function (data) {
                                $("#modTitle").html("You Lost The Game! The Answer Was: " + wordOrg);
                                $("#city").html(wordOrg)
                                $("#dataModal").modal("show");
                                $("#info").html(data);
                                $("#game").hide();
                                $("#again").show();
                            },
                            error: function(XMLHttpRequest, textStatus, errorThrown) {
                    
                            }  
                        });

                    }
                }
              });
            }); 

            function checkWin(){
                for(var i=0;i<$(".wordLettes").length;i++){
                    if(!($($(".wordLettes")[i]).hasClass("good"))){
                        return false;
                    }
                }
                return true;
            }

            function shuffle(array) {
                let counter = array.length;
            
                // While there are elements in the array
                while (counter > 0) {
                    // Pick a random index
                    let index = Math.floor(Math.random() * counter);
            
                    // Decrease counter by 1
                    counter--;
            
                    // And swap the last element with it
                    let temp = array[counter];
                    array[counter] = array[index];
                    array[index] = temp;
                }
                return array;
            }
        </script>
        <div id="playScreen" style="padding:
            50px;background-color:brown;color:white;display:none">
            <div class="row">
                <div class="col-md-3"></div>
                <div class="col-md-6" id="game">
                    <div class="row">
                        <div class="col-md-12" style="font-size:
                            26px;font-weight:bold"><span id="welcome"></span></div><br><br>
                        <br><Br>
                    </div>
                    <div class="row">
                        <div class="col-md-12" style="font-size: 20px;"><p>Guess
                                The city name! <br> You Have <span id="Mis"></span>
                                mistakes left <span id="instr"></span></p></div>
                    </div>
                    <br><br>
                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"><p>Guess:</p></div>
                        <div class="col-md-9" style="width: 100%;">
                            <div id="word"></div> <br><br>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"><p>Letters:</p></div>
                        <div class="col-md-9" style="width: 100%;">
                            <div id="lettersOption"></div> <br><br>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"></div>
                        <div class="col-md-6"><button id="hint"
                                style="color:black;margin:auto;width:120px"
                                class="btn float-center">Hint!</button></div>
                        <div class="col-md-3"></div>
                    </div>

                </div>
                <div class="col-md-6" id="again" style="display:none;">
                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"></div>
                        <div class="col-md-6"><button id="playAgain"
                                style="color:black;margin:auto;width:120px"
                                class="btn float-center">Play Again</button></div>
                        <div class="col-md-3"></div>
                    </div>
                </div>
                <div class="col-md-3"></div>
            </div>
        </div>



        <div id="loginScreen"
            style="padding:50px;background-color:brown;color:white;">
            <div class="row">
                <div class="col-md-3"></div>
                <div class="col-md-6">
                    <div class="row">
                        <div id="welcome" class="col-md-12" style="font-size:
                            26px;font-weight:bold">Login To Play!</div><br><br>
                        <br><Br>
                    </div>
                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"><p>Username</p></div>
                        <div class="col-md-6"><input type="text" id="username"
                                class="form-control"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"><p>Password</p></div>
                        <div class="col-md-6"><input type="text" id="password"
                                class="form-control"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-3" style="font-size: 20px;"></div>
                        <div class="col-md-6"><button id="play"
                                style="color:black;margin:auto;width:120px"
                                class="btn float-center">Play!</button></div>
                        <div class="col-md-3"></div>
                    </div>

                </div>
                <div class="col-md-3"></div>
            </div>
        </div>

        <div class="modal" id="dataModal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 id="modTitle"></h1><br>
                        <h2 class="modal-title">The City Of <span id="city"></span></h5>
                    </div>
                    <div class="modal-body">
                        <p>The City is known for:</p>
                        <B><p><ul>Actors:</ul></p></B>
                        <span id="info"></span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                            data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>


    </body>
</html>